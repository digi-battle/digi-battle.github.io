<!DOCTYPE html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono:wght@100..900&display=swap" rel="stylesheet">

    <style>
        * {
            font-family: "Noto Sans Mono", monospace;
            font-optical-sizing: auto;
            font-weight: 500;
            font-style: normal;
            font-variation-settings: "wdth" 100;
            text-align: center;
        }

        html, body {
            padding: 0;
            margin: 0;
        }

        a {
            color: inherit !important;
        }

        p {
            margin-bottom: 0;
            opacity: 0.7;
        }

        h1, h2 {
            margin-top: 0;
        }

        h2 {
            margin-bottom: 2em;
        }

            h2 span {
                font-weight: bold;
            }

        .row {
            display: flex;
            flex-flow: column;
        }

        .column {
            width: 100%;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
        }

        .column h2 {
            padding: 0 1em;
        }

        .header {
            min-height: 200px;
            background-color: #386641;
            color: #fff;
        }

        .half {
            background-color: #F2E8CF;
            padding: 3em 0;
        }

            .half:nth-child(1) {
                background-color: #A7C957;
            }

        @media(min-width: 768px) {
            .row {
                display: flex;
                flex-flow: row;
            }

            .half {
                height: calc(100vh - 200px);
                padding: 0;
            }
        }
    </style>
</head>
<body>

    <div class="row">
        <div class="column header">
            <p>You haven't vaped in</p>
            <h1>
                <!-- <span>ðŸŽ‰</span> -->
                <span id="time-link"></span>
                <!-- <span>ðŸŽ‰</span> -->
            </h1>
        </div>
    </div>

    <div class="row">
        <div class="column half">
            <h2>That's <span id="puff-count"></span> puffs <span>ðŸ’¨</span></h2>

            <h2><span id="refill-count"></span> tank refills</h2>

            <h2><span id="bottle-count"></span> bottles finished</h2>

            <h2><span id="bottle-cost"></span> saved <span>ðŸ’µ</span></h2>

            <p>Your lungs and wallet say thank you!</h1>
        </div>

        <div class="column half">
            <h2 id="time-message"></h2>
            <h2 id="current-status"></h2>
            <h2>You can buy <span id="can-afford-now"></span> with the money you've saved!</h2>
        </div>
    </div>

    <div class="row">
        <div class="column header">
            <p>This page was heavily inspired by the works of <a href="https://neal.fun/" target="_blank" rel="noopener nofollow">https://neal.fun/</a></p>
        </div>
    </div>
    
    <script>

        //TODO:
        //- allow user to enter their own details:
        //    - when they stopped vaping
        //    - did they smoke disposabled / refillables / cigarettes ?
        //    - were they a light / moderate / heavy smoker
        //- save settings to cookies


        const startTime = new Date("2025-08-14T11:56:00");
        //const startTime = new Date("2025-02-12T01:56:00");
        //const startTime = new Date();
        const puffsPerMinute = 1;
        const refillsPerDay = 2;
        const bottlesPerWeek = 1; //1 per week (50ml bottle, 3.6ml per bottle)
        const bottleCost = 13;

        const affordables = [
            { Name: "nothing", Price: 0.00 },
            { Name: "a paperclip", Price: 0.01 },
            { Name: "an envelope", Price: 0.05 },
            { Name: "a first-class postage stamp", Price: 1.25 },
            { Name: "an energy drink", Price: 3.00 },
            { Name: "a paperback book", Price: 7.99 },
            { Name: "a 3-pack of cotton socks", Price: 12.00 },
            { Name: "a basic wired mouse", Price: 20.00 },
            { Name: "a casual restaurant meal", Price: 35.00 },
            { Name: "a new release video game", Price: 50.00 },
            { Name: "a budget microwave oven", Price: 120.00 },
            { Name: "an entry-level smartphone", Price: 200.00 },
            { Name: "an upright vacuum cleaner", Price: 300.00 },
            { Name: "a mid-range washing machine", Price: 450.00 },
            { Name: "a mid-range laptop", Price: 750.00 },
            { Name: "a high-end smartphone", Price: 1100.00 },
            { Name: "an entry-level electric bike", Price: 1500.00 },
            { Name: "a designer handbag", Price: 1800.00 },
            { Name: "a three-seater sofa", Price: 1950.00 },
            { Name: "a small used car", Price: 2000.00 }
        ];

        const statusProgress = [
            { Text: "You're at the start of your journey and you're doing great. Keep going!", Day: 0 },
            { Text: "Your cravings are the worst they will be. This is the hardest part, but it's nothing you can't handle. Occupy your brain and do something to take your mind off it. You can do it!", Day: 1 },
            { Text: "Nicotine has fully left your system. You may have mood swings or difficulty concentrating. Keep pushing!", Day: 3 },
            { Text: "Psychological withdrawal is now worse than the physical symptoms. Cravings are triggered by habits, routines or stress. Distract yourself and the craving will pass! You should have more energy by this point.", Day: 7 },
            { Text: "Your mood and sleep quality has improved dramatically. You don't ever want to go back!", Day: 30 },
            { Text: "You're doing amazing!", Day: 90 }
        ];


        function updateTime() {
            const now = new Date();
            const diffMs = now - startTime; // milliseconds difference

            // Convert to days, hours, minutes, seconds
            const seconds = Math.floor(diffMs / 1000) % 60;
            const minutes = Math.floor(diffMs / (1000 * 60)) % 60;
            const hours = Math.floor(diffMs / (1000 * 60 * 60)) % 24;
            const days = Math.floor(diffMs / (1000 * 60 * 60 * 24));

            let dayText = days === 0 ? '' : `${days} day${days > 1 ? 's' : ''}`;
            let hourText = hours === 0 ? '' : `${hours} hour${hours > 1 ? 's' : ''}`;
            let minuteText = minutes === 0 ? '' : `${minutes} minute${minutes > 1 ? 's' : ''}`;
            let secondText = seconds === 0 ? '' : `${seconds} second${seconds > 1 ? 's' : ''}`;

            // Update the <a> tag
            const link = document.getElementById("time-link");
            link.textContent = `${dayText} ${hourText} ${minuteText} ${secondText}`;

            const totalHours = diffMs / (1000 * 60 * 60);
            const totalPuffs = (totalHours * 60) * puffsPerMinute;
            const totalRefills = (totalHours / 12) * refillsPerDay;
            const totalBottles = (totalHours / 168) * bottlesPerWeek;
            const totalBottleCost = totalBottles * bottleCost;

            document.getElementById("puff-count").textContent = `${FormatNumber(totalPuffs)}`;
            document.getElementById("refill-count").textContent = `${FormatNumber(totalRefills)}`;
            document.getElementById("bottle-count").textContent = `${FormatNumber(totalBottles)}`;
            document.getElementById("bottle-cost").textContent = `${FormatPrice(totalBottleCost)}`;

            if (totalHours >= 3) {
                document.getElementById("time-message").textContent = `Since quitting, you could have watched The Wolf of Wall Street ${FormatNumber(totalHours / 3)} times.`;
            }

            const canAfford = affordables
                .filter(a => a.Price < totalBottleCost)
                .sort((a, b) => b.Price - a.Price)
                .map(a => a.Name)[0];
            document.getElementById("can-afford-now").textContent = canAfford;

            const currentStatus = statusProgress
                .filter(a => a.Day <= days)
                .sort((a, b) => b.Day - a.Day)
                .map(a => a.Text)[0];
            document.getElementById("current-status").textContent = currentStatus;
        }

        function FormatNumber(input) {
            return Math.floor(input).toLocaleString();
        }

        function FormatPrice(input) {
            return input.toLocaleString("en-GB", {
                style: "currency",
                currency: "GBP",
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }

        // Update every second
        updateTime(); // initial call
        setInterval(updateTime, 1000);
    </script>
</body>